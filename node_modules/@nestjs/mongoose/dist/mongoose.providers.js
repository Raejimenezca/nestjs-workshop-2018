"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const mongoose_utils_1 = require("./common/mongoose.utils");
const mongoose_constants_1 = require("./mongoose.constants");
function createMongooseProviders(connectionName = mongoose_constants_1.DEFAULT_DB_CONNECTION, models = []) {
    const providers = (models || []).map(model => ({
        provide: mongoose_utils_1.getModelToken(model.name),
        useFactory: (connection) => connection.model(model.name, model.schema, model.collection),
        inject: [
            connectionName === mongoose_constants_1.DEFAULT_DB_CONNECTION
                ? mongoose_constants_1.DEFAULT_DB_CONNECTION
                : mongoose_utils_1.getConnectionToken(connectionName),
        ],
    }));
    return providers;
}
exports.createMongooseProviders = createMongooseProviders;
